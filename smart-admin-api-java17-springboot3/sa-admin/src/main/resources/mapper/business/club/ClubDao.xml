<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.lab1024.sa.admin.module.business.club.dao.ClubDao">

    <!-- 分页查询俱乐部 -->
    <select id="queryPage" resultType="net.lab1024.sa.admin.module.business.club.domain.vo.ClubListVO">
        SELECT
            club_id,
            club_name,
            club_code,
            logo_url,
            carousel_images,
            business_start_time,
            business_end_time,
            address,
            phone,
            province,
            city,
            district,
            contact_person,
            contact_phone,
            create_by,
            create_time,
            is_valid
        FROM m_club
        <where>
            is_delete = #{queryForm.isDelete}
            <if test="queryForm.keywords != null and queryForm.keywords != ''">
                AND (
                    INSTR(club_name, #{queryForm.keywords})
                    OR INSTR(contact_person, #{queryForm.keywords})
                    OR INSTR(phone, #{queryForm.keywords})
                    OR INSTR(contact_phone, #{queryForm.keywords})
                )
            </if>
            <if test="queryForm.province != null and queryForm.province != ''">
                AND province = #{queryForm.province}
            </if>
            <if test="queryForm.city != null and queryForm.city != ''">
                AND city = #{queryForm.city}
            </if>
            <if test="queryForm.district != null and queryForm.district != ''">
                AND district = #{queryForm.district}
            </if>
            <if test="queryForm.startDate != null and queryForm.startDate != ''">
                AND DATE_FORMAT(create_time, '%Y-%m-%d') &gt;= #{queryForm.startDate}
            </if>
            <if test="queryForm.endDate != null and queryForm.endDate != ''">
                AND DATE_FORMAT(create_time, '%Y-%m-%d') &lt;= #{queryForm.endDate}
            </if>
            <if test="queryForm.isValid != null">
                AND is_valid = #{queryForm.isValid}
            </if>
        </where>
        <if test="queryForm.sortItemList == null or queryForm.sortItemList.size == 0">
            ORDER BY create_time DESC
        </if>
    </select>

    <!-- 根据俱乐部编码查询 -->
    <select id="selectByClubCode" resultType="net.lab1024.sa.admin.module.business.club.domain.entity.ClubEntity">
        SELECT * FROM m_club
        WHERE club_code = #{clubCode} AND is_delete = 0
        LIMIT 1
    </select>

    <!-- 根据俱乐部名称查询 -->
    <select id="selectByClubName" resultType="net.lab1024.sa.admin.module.business.club.domain.entity.ClubEntity">
        SELECT * FROM m_club
        WHERE club_name = #{clubName} AND is_delete = 0
        LIMIT 1
    </select>

    <!-- 俱乐部列表查询 -->
    <select id="queryList" resultType="net.lab1024.sa.admin.module.business.club.domain.vo.ClubListVO">
        SELECT
            club_id,
            club_name,
            club_code,
            logo_url,
            carousel_images,
            business_start_time,
            business_end_time,
            address,
            phone,
            province,
            city,
            district,
            contact_person,
            contact_phone,
            create_by,
            create_time,
            is_valid
        FROM m_club
        WHERE is_delete = 0
        <if test="isValid != null">
            AND is_valid = #{isValid}
        </if>
        ORDER BY create_time DESC
    </select>

</mapper>
