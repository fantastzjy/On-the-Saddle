<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="net.lab1024.sa.admin.module.business.member.dao.MembershipRenewHistoryDao">

    <!-- 根据会员ID查询续费历史 -->
    <select id="getMembershipHistoryByMemberId" resultType="net.lab1024.sa.admin.module.business.member.domain.vo.MembershipRenewHistoryVO">
        SELECT
            id,
            member_id,
            renew_months,
            renew_amount,
            old_expire_date,
            new_expire_date,
            payment_method,
            remark,
            renew_date,
            create_by
        FROM m_membership_renew_history
        WHERE member_id = #{memberId} AND is_delete = 0
        ORDER BY renew_date DESC
    </select>

    <!-- 查询会员最近一次续费记录 -->
    <select id="getLastRenewRecord" resultType="net.lab1024.sa.admin.module.business.member.domain.entity.MembershipRenewHistoryEntity">
        SELECT * FROM m_membership_renew_history 
        WHERE member_id = #{memberId} AND is_delete = 0
        ORDER BY renew_date DESC
        LIMIT 1
    </select>

</mapper>